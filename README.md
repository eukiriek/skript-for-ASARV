# маска пустых значений (NaN или пустая строка)
mask_ots_empty = df["Время отсутствия"].isna() | (df["Время отсутствия"].astype(str).str.strip() == '')

# заполняем пустые строки корректным значением
df.loc[mask_ots_empty, "Время отсутствия"] = "00:00:00"

# пробуем привести к timedelta
df["Время отсутствия"] = pd.to_timedelta(df["Время отсутствия"], errors="coerce")

# снова заполняем некорректные парсы
df["Время отсутствия"] = df["Время отсутствия"].fillna(pd.Timedelta(seconds=0))

# переводим timedelta → строка hh:mm:ss
df["Время отсутствия"] = df["Время отсутствия"].apply(td_to_hms)
