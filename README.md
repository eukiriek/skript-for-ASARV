# признак типа подразделения: ЕСЦ / КЦ / ГО

# очистка строк
df["Полное наименование"] = clean_str(df["Полное наименование"])
df["Подразделение 2"] = clean_str(df["Подразделение 2"])

# маски для условий
mask_esc = df["Полное наименование"].str.contains("сервисный центр",
                                                  case=False, na=False)
mask_kc = df["Подразделение 2"].str.contains("контакт-центр",
                                             case=False, na=False)

# новое поле, по умолчанию ГО
df["Тип подразделения"] = "ГО"

# ЕСЦ
df.loc[mask_esc, "Тип подразделения"] = "ЕСЦ"

# КЦ (если нужно, можно считать приоритетнее ЕСЦ)
df.loc[mask_kc, "Тип подразделения"] = "КЦ"

# если старые поля больше не нужны, можно удалить
df.drop(columns=["ЕСЦ", "КЦ"], errors="ignore", inplace=True)

print("-- добавлено поле 'Тип подразделения' (ЕСЦ / КЦ / ГО).")
